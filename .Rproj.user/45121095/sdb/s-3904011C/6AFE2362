{
    "collab_server" : "",
    "contents" : "<!--\n%\\VignetteEngine{knitr::rmarkdown}\n%\\VignetteIndexEntry{An Introduction to GFD}\n-->\n\n\n## Introduction\n\nThis vignette documents the use of the `GFD` function for the analysis of general factorial designs. The `GFD` function\ncalculates the Wald-type statistic (WTS), the ANOVA-type statistic (ATS) and a permuted Wald-type statistic (WTPS). \nThese test statistics can be used for general factorial designs (crossed or nested) with an arbitrary number of \nfactors, unequal covariance matrices among groups and unbalanced data even for small sample sizes.\n\n## Data Example (crossed design)\n\nFor illustration purposes, we will use the data set `pizza` which is included in the `GFD` package. We first load the\n`GFD` package and the data set.\n\n```{r}\nlibrary(GFD)\ndata(pizza)\n```\n\nThe objective of the study was to see how the delivery time in minutes would be affected by\nthree different factors: whether thick or thin crust was ordered (factor A), whether Coke was\nordered with the pizza or not (factor B), and whether or not garlic bread was ordered as a\nside (factor C). \n\n```{r}\nhead(pizza)\n```\n\nThis is a three-way crossed design, where each factor has two levels. We will now analyze this design with the `GFD` function. \nThe `GFD` function takes as arguments:\n* `formula`: A formula consisting of the outcome variable on the left hand side of a \\~ operator and the factor\nvariables of interest on the right hand side. An interaction term must be specified.\n* `data`: A data.frame, list or environment containing the variables in `formula`.\n* `nperm`: The number of permutations. Default value is 10000.\n* `alpha`: The significance level, default is 0.05.\n* `CI.method`: Specifies the method used for calculating the CIs, either `t-quantile` (default) or `perm`. \n\n```{r}\nset.seed(1234)\nmodel1 <- GFD(Delivery ~ Crust * Coke * Bread, data = pizza, nperm = 1000, alpha = 0.05)\nsummary(model1)\n```\n\nThe output consists of three parts: `model1$Descriptive` gives an overview of the descriptive statistics: The number of observations, \nmean and variance as well as confidence intervals (based on quantiles of the t-distribution or the permutation distribution) are displayed for each factor level combination.\n`model1$WTS` contains the results for the Wald-type test: The test statistic, degree of freedom and p-values based on the asymptotic $\\chi^2$ distribution\nand the permutation procedure, respectively, are displayed. Note that the $\\chi^2$ approximation is very liberal for small sample sizes and therefore the WTPS is \nrecommended for such situations. Finally, `model1$ATS` contains the corresponding results based on the ATS. This test statistic tends to rather\nconservative decisions in the case of small sample sizes and is even asymptotically only an approximation, thus not providing an asymptotic level $\\alpha$ test.\n\nWe find a significant influence of the factors Crust and Bread. The WTS and WTPS also\nsuggest a significant interaction between the factors Crust and Coke at 5% level, which is only\nborderline significant when using the ATS.\n\n## Data example (nested design)\n\nNested designs can also be analyzed using the `GFD` function. \nNote that in nested designs, the levels of the nested factor usually have the same labels\nfor all levels of the main factor, i.e., for each level $i=1, ..., a$ of the main factor A\nthe nested factor levels are labeled as $j=1, ..., b_i$. If the levels of the nested factor \nare named uniquely, this has to be specified by setting the parameter `nested.levels.unique`\nto TRUE.\nIn this package, only analysis of balanced\nnested designs is possible, that is, the same number of levels of the nested factor for each level\nof the main factor.\n\nWe consider the data set `curdies` from the `GFD` package:\n\n```{r}\ndata(\"curdies\")\nset.seed(987)\nnested <- GFD(dugesia ~ season + season:site, data = curdies, nested.levels.unique = TRUE)\nsummary(nested)\n```\n\nThe aim of the study was to describe basic patterns of variation in a small flatworm, Dugesia, in the Curdies\nRiver, Western Victoria. Therefore, worms were sampled at two different seasons and three\ndifferent sites within each season. For our analyses we consider both factors as fixed (e.g.,\nsome sites may only be accessed in summer). In this setting, both WTS and WTPS detect a significant influence of the season whereas\nthe ATS, again, only shows a borderline significance at 5% level. The effect of the site is not\nsignificant.\n\n## Plotting\n\nThe `GFD` package is equipped with a plotting function, displaying the calculated means along with $(1-\\alpha)$ confidence intervals.\nThe `plot` function takes a `GFD` object as an argument. In addition, the factor of interest may be specified. If this argument is \nomitted in a two- or higher-way layout, the user is asked to specify the factor for plotting. Furthermore, additional graphical parameters\ncan be used to customize the plots. The optional argument `legendpos` specifies the position of the legend in higher-way layouts.\n\n```{r}\nplot(model1, factor = \"Crust:Coke:Bread\", legendpos = \"center\", main = \"Delivery time of pizza\", xlab = \"Bread\")\nplot(model1, factor = \"Crust:Coke\", legendpos = \"topleft\", main = \"Two-way interaction\", xlab = \"Coke\", col = 3:5, pch = 17)\nplot(nested, factor = \"season:site\", xlab = \"site\")\n```\n\n## optional GUI\n\nThe `GFD` package is equipped with an optional graphical user interface, which is based on `RGtk2`. The GUI may be started in `R` (if `RGtk2` is installed) using the\ncommand `calculateGUI()`. \n\n```{r}\ncalculateGUI()\n```\n\nThe user can specify the data location\n(either directly or via the \"load data\" button), the formula, the number of permutations and\nthe significance level. Additionally, one can specify whether or not headers are\nincluded in the data file, and which separator (e.g., ',' for *.csv files) and character symbols are used for decimals\nin the data file. The GUI also provides a plotting option, which generates a new window\nfor specifying the factors to be plotted (in higher-way layouts) along with a few plotting\nparameters.\n",
    "created" : 1496747709727.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1736743555",
    "id" : "6AFE2362",
    "lastKnownWriteTime" : 1513603655,
    "last_content_update" : 1513603655235,
    "path" : "~/Documents/Studium/02 Uni Ulm/02 Promotion/R-packages/GFD/vignettes/IntroductionToGFD.Rmd",
    "project_path" : "vignettes/IntroductionToGFD.Rmd",
    "properties" : {
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}